<?xml version="1.0" encoding="UTF-8"?>

<!--
	@package xpotronix
	@version 2.0 - Areco 
	@copyright Copyright &copy; 2003-2011, Eduardo Spotorno
	@author Eduardo Spotorno
 
	Licensed under GPL v3
	@license http://www.gnu.org/licenses/gpl-3.0.txt
-->

<config>
	<db_instance name="default-acl">
		<table_prefix>gacl_</table_prefix>
		<fetch_mode>1</fetch_mode>
	</db_instance>
	<gacl_class>\Xpotronix\Acl</gacl_class>
	<gacl_table_prefix>gacl_</gacl_table_prefix>
	<gacl_cache_time>0</gacl_cache_time>


	<acl_schema name="default"><![CDATA[

	[request_definition]
	r = sub, obj, act

	[policy_definition]
	p = sub, obj, act

	[role_definition]
	g = _, _
	g2 = _, _

	[policy_effect]
	e = some(where (p.eft == allow))

	[matchers]
	m = g(r.sub, p.sub) && g2(r.obj, p.obj) && r.act == p.act || r.sub == "administrator"

	]]></acl_schema>


</config>
